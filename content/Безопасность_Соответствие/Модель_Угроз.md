# 6.2. Threat model для coding‑агентов (prompt injection, supply chain, эксфильтрация)

- **Last reviewed**: 2026-01-15
- **Уровень**: Advanced

## Зачем эта страница

Зафиксировать модель угроз: агент — полезен, но **частично недоверенный исполнитель** с доступом к файлам и инструментам.

## Attack surface (упрощённо)

- **Prompt injection**:
  - через README/комментарии/файлы в репозитории
  - через логи/тикеты/пейлоады ("сделай вот это, проигнорируй правила…")
- **Supply chain**:
  - агент добавляет зависимости/скрипты без контроля
  - подменённые пакеты/скрипты/шаблоны
- **Эксфильтрация**:
  - через терминал/сетевые запросы/интеграции (MCP, плагины)
- **IDE/Agent execution risks**:
  - авто‑запуск команд
  - обработка untrusted файлов с "инструкциями"

## Базовые меры защиты (чек‑лист)

- **No auto‑run**: запуск команд только после явного approve.
- **Least privilege**: ограничить инструменты/папки/интеграции.
- **Allowlist**: только разрешённые MCP‑серверы и плагины.
- **STOP‑POINT'ы**: план → подтверждение → изменения → подтверждение → команды.
- **Code owners / ревью зон риска**: auth/db/crypto/CI.
- **Secret scanning** в репо и на PR.

## Практический вывод для процессов

- Уровни автономности выше **A2** — только при наличии hard guardrails.
- Агент не должен иметь доступ к D2/D3 данным в SaaS‑контуре.
- Любой "инцидент" в работе агента должен иметь postmortem и обновление политики.

## Связанные страницы

- [6.3 IDEsaster / Secure for AI](IDEsaster_Безопасность_для_AI.md)
- [6.5 Advanced guardrails](Продвинутые_Ограничения.md)
- [7.2 Агент в CI: agent‑runner](../Корпоративная_Интеграция/Агент_в_CI_Раннер.md)

